<form method="post" action="{{ path('app_login') }}" autocomplete="off">
    {% if error %}
        <div class="alert alert-danger">{{ error.messageKey|trans(error.messageData, 'security') }}</div>
    {% endif %}

    {% if app.user %}
        <div class="mb-3">
            You are logged in as {{ app.user.userIdentifier }}, <a href="{{ path('app_logout') }}">Logout</a>
        </div>
    {% endif %}

    <h1 class="h3 mb-3 font-weight-normal">Please sign in</h1>

    <div class="mb-3">
        <label for="username">Username</label>
        <input 
            type="text" 
            value="{{ last_username }}" 
            name="_username" 
            id="username" 
            class="form-control" 
            autocomplete="off" 
            required 
            autofocus
        >
    </div>

    <div class="mb-3">
        <label for="password">Password</label>
        <input 
            type="password" 
            name="_password" 
            id="password" 
            class="form-control" 
            autocomplete="new-password" 
            required
        >
    </div>

    <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

    <button class="btn btn-lg btn-primary mt-2" type="submit">Sign in</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const passwordInput = document.getElementById('password');
    if (passwordInput && !document.getElementById('togglePassword')) {
        const toggleButton = document.createElement('button');
        toggleButton.type = 'button';
        toggleButton.id = 'togglePassword';
        toggleButton.className = 'btn btn-secondary mt-2';
        toggleButton.textContent = 'Mostrar Contraseña';
        
        toggleButton.addEventListener('click', function() {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleButton.textContent = 'Ocultar Contraseña';
            } else {
                passwordInput.type = 'password';
                toggleButton.textContent = 'Mostrar Contraseña';
            }
        });
        
        passwordInput.parentNode.appendChild(toggleButton);
    }
});
</script>