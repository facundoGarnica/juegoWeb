{% extends 'base.html.twig' %}
{% block title %}ArrayRun Nivel 2{% endblock %}
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/ArrayRun-lvl1.css') }}">
{% endblock %}
{% block body %}
    <div id="game-container" style="width: 100%; height: 100vh; overflow: hidden;"></div>
{% endblock %}
{% block javascripts %}
    <!-- Phaser CDN -->
    <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
    
    <!--  VARIABLES GLOBALES PRIMERO (antes del módulo) -->
    <script>
        // Variables de rutas y assets
        window.background_path = "{{ asset('images/ArrayRun') }}";
       const MENU_URL = "{{ path('app_arrayrun', { userId: user.id }) }}";

        
        //  Variables del juego (CRÍTICO: antes del módulo)

        const CURRENT_PLAYER_ID = {{ player.id }};
        window.CURRENT_LEVEL_ID = {{ numero }};
        //console.log(CURRENT_LEVEL_ID);
        const SAVE_LEVEL_PATH = "{{ path('app_user_level_save') }}";
        window.CURRENT_GAME_ID = {{ gameId }};
        window.levelsByGameUrl = "{{ path('api_levels_by_game', {'gameId': gameId}) }}";
        //path del sprite del jugador actual
        window.CURRENT_PLAYER_SPRITE = "{{ player.nameSprite}}";
         // Datos del player
    window.CURRENT_PLAYER = {
        id: {{ player.id }},
        nombre: "{{ player.nombre }}",
        vida_actual: {{ player.vidaActual }},
        vida_maxima: {{ player.vidaMaxima }},
        speed: {{ player.speed ?? 0 }},
        jumpSpeed: {{ player.jumpSpeed ?? 0 }},
    };

    </script>
   
    <!-- ✅ Script principal del juego DESPUÉS de las variables -->
    <script type="module" src="{{ asset('js/ArrayRunScript/game2.js') }}"></script>
{% endblock %}